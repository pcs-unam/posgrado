{% extends "posgradmin/posgradmin_base.html" %}

{% block content_title %}
{% endblock %}

{% block content %}

<div class="row">
  <div class="col-sm-4">

    <div class="panel panel-default">
      <div class="panel-heading">
	<h3 class="panel-title">
	  {% if not user.perfil %}
	  <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
	  Perfil
	  {% elif user.estudiante %}
	  <span class="glyphicon glyphicon-education" aria-hidden="true"></span>
	  Estudiante [{{ user.estudiante.estado }}]
	  {% elif user.academico %}
	  <span class="glyphicon glyphicon-education" aria-hidden="true"></span>
	  Académico
	  {% endif %}
	</h3>
      </div>
      <div class="panel-body">
	{% if user.perfil %}

	{% if user.headshot %}
	<img src="/media/headshots/{{ user.id }}.png" width="100px" />
	{% endif %}
	<h4>{{ user.get_full_name }}</h4>

	<p><a href="perfil/">Ver mi perfil</a></p>


	{% if user.estudiante %}

	{% if user.estudiante.faltan_documentos %}
	<div class="alert alert-danger" role="alert">
	  <strong>No ha registrado grados académicos</strong>
	  <a href="/inicio/perfil/agregar-grado">Agregar grados académicos</a>.
	</div>
	{% else %}
	<ul class="list-group">
	  {% for grado in user.gradoacademico_set.all %}
	  <li class="list-group-item">
	    <strong>{{ grado.grado_obtenido }} </strong>@ {{ grado.institucion }}, {{ grado.facultad }}
	    <p class="list-group-item-text">nivel {{ grado.nivel }}
	  </li>
	  {% endfor %}
	</ul>
	{% endif %}


	{% if user.estudiante.get_proyecto is None %}
	<div class="alert alert-danger" role="alert">
	  <strong>No ha registrado proyecto</strong> <a href="/inicio/estudiante/registro">registre proyecto</a>
	</div>
	{% else %}
	<ul class="list-group">
	  <li class="list-group-item">
	    <h4>Proyecto: {{ user.estudiante.get_proyecto.nombre }}</h4>
	    Campo de Conocimiento: {{ user.estudiante.proyecto_set.last.campo_conocimiento }}

	    {% if not user.estudiante.get_proyecto.aprobado %}
	    <div class="alert alert-warning" role="alert">
	      <span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span>
	      Proyecto no aprobado.
	      Ver solicitud {{ user.estudiante.get_proyecto.solicitud.as_a|safe }}.

	    </div>
	    {% endif %}

	    {% if user.estudiante.get_proyecto_no_aprobado %}
	    <div class="alert alert-warning" role="alert">
	      <span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span>
	      Solicitud de cambio: {{ user.estudiante.get_proyecto_no_aprobado }}
	      Ver <a href="/inicio/solicitudes/{{ user.estudiante.get_proyecto_no_aprobado.solicitud.id }}">
		#{{ user.estudiante.get_proyecto_no_aprobado.solicitud.id }}</a>.
	    </div>
	    {% endif %}


	  </li>
	</ul>
	{% endif %}
	{% endif %}



	{% if user.academico %}
	   {% if user.academico.tutor %}
	       <p><a href="/inicio/comites/mis">Mis comités de jurado</a></p>
	       <p><a href="/inicio/estudiantes/mis">Mis estudiantes</a></p>
	   {% endif %}
	   <p><a href="/inicio/catedras/mis">Mis cátedras</a></p>

	   {% if user.academico.solicitud.dictamen_final.resolucion == 'denegada' or user.academico.solicitud.estado == 'cancelada' %}
	       <a href="/inicio/academico/registro">registrarse como académico</a>
	   {% else %}
	       Registro como académico en proceso a través de la solicitud
	       <a href="/inicio/solicitudes/{{ user.academico.solicitud.id }}">
		 {{ user.academico.solicitud.as_a|safe }}</a>.
	   {% endif %}


	<ul class="list-group">
	  {% for grado in user.gradoacademico_set.all %}
	  <li class="list-group-item">
	    <strong>{{ grado.grado_obtenido }} </strong>@ {{ grado.institucion }}, {{ grado.facultad }}
	    <p class="list-group-item-text">nivel {{ grado.nivel }}
	  </li>
	  {% endfor %}
	</ul>

	<ul class="list-group">
	  {% for ad in user.academico.adscripcion_set.all %}
	  <li class="list-group-item">
	    {{ ad.nombramiento }} en {{ ad.institucion }}
	  </li>
	  {% empty %}
	  <div class="alert alert-danger" role="alert">
	    <strong>No ha registrado adscripciones</strong>
	    <a href="/inicio/perfil/agregar-adscripcion">Agregar adscripción</a>.
	  </div>
	  {% endfor %}
	</ul>

	{% endif %}


	{% if user.is_staff or user.asistente %}

	{% elif not user.academico %}
	<ul>
	  <li><a href="/inicio/academico/registro">registrarse como académico</a></li>
	</ul>
	{% endif %}

	{% else %}
	  Para interactuar con el programa de posgrado necesitamos algunos datos personales y de contacto:
	  <a href="/inicio/perfil/editar">Completar registro de perfil</a>
	  {% endif %}
      </div>
    </div>


  </div><!-- /.col-sm-4 -->


<!-- Solicitudes -->
{% if user.estudiante or user.academico or user.asistente or user.is_staff %}
  <div class="col-sm-4">
    <div class="panel panel-info">
      <div class="panel-heading">
	<h3 class="panel-title">
	  <span class="glyphicon glyphicon-inbox" aria-hidden="true"></span>
	  <a href="/inicio/solicitudes/">Solicitudes</a></h3>
      </div>
      <div class="panel-body">
	<p>
	<a href="/inicio/solicitudes/nueva">
	  <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
	  nueva solicitud
	</a>
	</p>
	<!-- lista conteo -->
	<ul class="list-group">
	  {% if user.is_staff or user.asistente  %}

	  {% for s in user.asistente.cuantas_solicitudes %}
	  <li class="list-group-item">
	    <a href="/inicio/solicitudes/e/{{ s.0 }}">{{ s.0 }} <span class="badge">{{ s.1 }}</span></a>
	  </li>
	  {% endfor %}

	  {% elif user.academico %}

	  {% for s in user.academico.cuantas_solicitudes %}
	  <li class="list-group-item">
	    <a href="/inicio/solicitudes/e/{{ s.0 }}">{{ s.0 }} <span class="badge">{{ s.1 }}</span></a>
	  </li>
	  {% endfor %}

	  {% elif user.estudiante %}

	  {% for s in user.estudiante.cuantas_solicitudes %}
	  <li class="list-group-item">
	    <a href="/inicio/solicitudes/e/{{ s.0 }}">{{ s.0 }} <span class="badge">{{ s.1 }}</span></a>
	  </li>
	  {% endfor %}

	  {% endif %}

	</ul>

      </div>
    </div>
{% endif %}

  </div>
</div>

{% if user.is_staff or user.asistente %}
<div class="row">
  <div class="col-sm-4">

    <div class="panel panel-warning">
      <div class="panel-heading">
	<h3 class="panel-title">
	  <span class="glyphicon glyphicon-king" aria-hidden="true"></span>
	  Coordinación
	</h3>
      </div>
      <div class="panel-body">
	<p><a href="/inicio/estudiantes/">Estudiantes</a></p>
	<p><a href="/inicio/academicos/">Académicos</a></p>
	<p><a href="/inicio/catedras/">Cátedras</a></p>
	<p><a href="/inicio/sesiones/">Sesiones del Comité Académico</a></p>
	<p><a href="/admin/">Base de Datos</a></p>
      </div>
    </div>
  </div>
</div>
{% endif %}





{% endblock %}
