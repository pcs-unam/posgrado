{% extends "posgradmin/posgradmin_base.html" %}
{% load md2 %}

{% block content %}

<a href="/admin/posgradmin/estudiante/">tabla de estudiantes</a>

<hr />


<div class="flex flex-row">
  {% if U.perfil.headshot %}
  <div>
    <img alt="" class="media-object"
	 width="150px"
	 src="{{ U.perfil.headshot.url }}" />
  </div>
  {% endif %}

  <div class="text-green-800 text-2xl">
    {{ estudiante }}
  </div>
</div>



<ul class="rounded shadow m-2 p-4 bg-gray-100">
  <li>Género {{ estudiante.user.perfil.genero }}</li>
  <li>Fecha nacimiento {{ estudiante.user.perfil.fecha_nacimiento }}</li>
  <li>Nacionalidad {{ estudiante.user.perfil.nacionalidad }}</li>
</ul>


<div class="flex flex-row">

  <ul class="rounded shadow m-2 p-4 bg-blue-100">
    {% if estudiante.user.perfil.telefono %}<li>tel.: {{ estudiante.user.perfil.telefono }}</li>{% endif %}
    {% if estudiante.user.perfil.telefono_movil %}<li>móvil: {{ estudiante.user.perfil.telefono_movil}}</li>{% endif %}
    {% if estudiante.user.perfil.website %}<li>website: <a href="{{ estudiante.user.perfil.website }}">{{ estudiante.user.perfil.website }}</a></li>{% endif %}
    <li><a href="mailto:{{ estudiante.user.email }}">{{ estudiante.user.email }}</a></li>
    {% if estudiante.user.perfil.direccion1 %}<li>dirección: {{ estudiante.user.perfil.direccion1 }} CP {{ estudiante.user.perfil.codigo_postal }}</li>{% endif %}
  </ul>

  <ul class="rounded shadow m-2 p-4 bg-blue-100">
    {% if estudiante.user.perfil.CVU %}<li>CVU: {{ estudiante.user.perfil.CVU }}</li>{% endif %}
    <li>CURP: {{ estudiante.user.perfil.curp }}</li>
    <li>RFC: {{ estudiante.user.perfil.rfc }}</li>
  </ul>

</div>

<div class="flex flex-row">

  <ul class="rounded shadow m-2 p-4 bg-green-100">
    <li>Plan de estudios: <strong>{{ estudiante.plan }}</strong></li>
    <li>Generación: {{ estudiante.generacion }}</li>
    <li>Última inscripción: {{ estudiante.ultima_inscripcion }}</li>
    <li>Entidad: {{ estudiante.entidad }}</li>
    <li>Estatus: {{ estudiante.estado }}</li>
  </ul>

</div>


{% if estudiante.ultimo_proyecto %}
<div class="rounded shadow m-2 p-4 bg-orange-100">
  <h2 class="text-l">Proyecto</h2>
  <ul class="">
    <li>
      {{ estudiante.ultimo_proyecto.titulo }}
    </li>
  </ul>
</div>
{% endif %}

{% if estudiante.campo_conocimiento %}
<div class="rounded shadow m-2 p-4 bg-orange-100">
  <h2 class="text-l">Campo de Conocimiento</h2>
  {{ estudiante.campo_conocimiento }}
</div>
{% endif %}


{% if estudiante.lineas_investigacion %}
<div class="rounded shadow m-2 p-4 bg-orange-100">
  <h2 class="text-l">Linea de investigación</h2>
  {{ estudiante.lineas_investigacion }}
</div>
{% endif %}


<div class="flex flex-col rounded shadow m-2 p-4 bg-amber-50">

  <h2 class="text-l">Grados Académicos</h2>

  {% for g in estudiante.user.gradoacademico_set.all %}
  <div class="m-2 p-2 bg-lime-50 shadow">
    <em>{{ g.fecha_obtencion }}</em><br />
    <strong>{{ g.grado_obtenido }}</strong>
    (nivel {{ g.nivel }}) <br />
    {{ g.institucion }}
  </div>
  {% endfor %}

</div>


{% if estudiante.comite_vigente %}
<div class="rounded shadow m-2 p-4 bg-lime-100">
  <h2 class="text-l">Comité ({{ estudiante.ultima_inscripcion }})</h2>
  <div class="bg-gray-100">
  <table>
    {% for m in estudiante.comite_vigente %}
    <tr>
      <td>
	{{ m.get_tipo_display }}
      </td>
      <td>
	{% if m.tutor %}
	{{ m.tutor }}
	{% elif m.invitado %}
	{{ m.invitado }} (invitado)
	{% endif %}
      </td>
    </tr>
    {% endfor %}
  </table>
  </div>
</div>
{% endif %}


{% if estudiante.notas.count > 0 %}
<div class="rounded shadow m-2 p-4 bg-amber-100">
  <h2>Notas</h2>
  {% for n in estudiante.notas.all %}
  <div class="bg-slate-100 shadow p-2">
    <div class="text-gray-600 float-right">{{ n.fecha }}, {{ n.autor }}, {{ n.estado }}</div>
    <div class="text-gray-800 font-bold text-xl mb-2">{{ n.asunto }}</div>
    {{ n.nota|markdown }}
  </div>
  {% endfor %}
</div>
{% endif %}

<div class="rounded shadow m-2 p-4 bg-stone-100">
  <h2 class="text-l">Historial</h2>
  <div class="bg-gray-100">
  <table>
    {% for h in estudiante.historial.all %}
    <tr>
      <td>{{ h.fecha }}</td><td>{{ h.estado }}</td><td>{{ h.plan }}</td><td>{{ h.institucion }}</td><td>{{ h.notas_set.all }}</td>
    </tr>
    {% endfor %}
  </table>
  </div>
</div>

{% endblock %}
